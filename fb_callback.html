<!doctype html>
<html lang="en">
  <meta charset="utf-8" />
  <title>Facebook Callback</title>
  <script>
    (function () {
      console.log("fb_callback.html loaded");

      if (!window.opener) {
        console.error("No opener window");
        return;
      }

      const qs = new URLSearchParams(window.location.search);
      const target = qs.get("state"); // parent origin
      console.log("targetOrigin =", target);

      if (!target) {
        console.error("No targetOrigin (state) in URL");
        return;
      }

      // tam URL'yi geri gÃ¶nder (code dahil)
      window.opener.postMessage(window.location.href, target);

      console.log("Message posted to opener");
      setTimeout(() => window.close(), 100);
    })();
  </script>
</html>
